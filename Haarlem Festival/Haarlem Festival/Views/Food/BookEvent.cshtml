@model Haarlem_Festival.Models.View_Models.Food.RestaurantBooking

<head>
    @Scripts.Render("~/Scripts/jquery.unobtrusive-ajax")
</head>

<section id="loaderDiv" hidden>
    <img src="@Url.Content("~/Content/Food/img/loading.gif")" />
</section>

<section id="ticketbookingsection">
    <section class="modal-header">
        <a href="#" class="close" data-dismiss="modal">&times;</a>
        <h3 class="modal-title">Book @Model.RestaurantName</h3>
    </section>


    @using (Html.BeginForm("BookRestaurant", "Food", FormMethod.Post, new { id = "ticketformid" }))
    {
        @Html.ValidationSummary(false, "", new { @class = "text-danger" })

        @Html.HiddenFor(item => item.RestaurantId, new { restaurantId = Model.RestaurantId })
        <section class="container-fluid">
            <section class="row" id="dateSelect">
                <br />
                <label class="col-sm-offset-2 col-sm-4">Date:</label>
                <section class="col-sm-4">
                    @Html.DropDownListFor(item => item.SelectedEvent,
                      new SelectList(Model.Events, "EventId", "StartTime"),
                      new { selectedEvent = Model.SelectedEvent })
                </section>
            </section>
            <section class="row" id="dateSelectSubtext">
                <p class="col-sm-offset-6 col-sm-4">The approximate time you have at this restaurant is @Model.TimeAvailable hours</p>
            </section>

            <hr />

            <section class="row" id="adultsorchildren">
                <label class="col-sm-offset-2 col-sm-4">Amount of adults: </label>
                <section class="col-sm-4">
                    @Html.TextBoxFor(item => item.AdultTickets)
                </section>
                <br /><br />
                <label class="col-sm-offset-2 col-sm-4">Amount of children:</label>
                <section class="col-sm-4">
                    @Html.TextBoxFor(item => item.ChildTickets)
                </section>
            </section>

            <hr />

            <section class="row" id="specialwishes">
                <label>Special Request:</label><br />
                <section class="col-sm-offset-1 col-sm-10">
                    @Html.TextAreaFor(item => item.SpecialRequest, new { @placeholder = "E.G.: Allergies, special vegan wishes or 'do you have that particular wine?'" })
                </section>
            </section>

            <br />

            <section class="row">
                <button href="#" id="bookRestaurantSubmit" type="submit" class="col-sm-offset-1 col-sm-10 btn btn-primary">Add to Shoppingcart</button>
            </section>
        </section>
    }
</section>

@section scripts {
    <script>
        $(document).ready(function () {
            $("#MyModal").on("submit", "#ticketformid", function (e) {
                e.preventDefault(); // Prevent default submission (?)

                var ticketform = $(this);
                $.ajax({
                    url: ticketform.attr("action"),
                    method: ticketform.attr("method"),
                    data: ticketform.serialize(),
                    success: function (partialResult) {
                        $("#ticketbookingsection").html(partialResult);
                    }
                });
            });
        });

        window.onload = function () {
            if (window.jQuery) {
                // jQuery is loaded  
                alert("Yeah!");
            } else {
                // jQuery is not loaded
                alert("Doesn't Work");
            }
        }



            //$(document).ready(function () {
            //    $("#bookRestaurantSubmit").click(function () {
            //        $("#loaderDiv").show();

            //        var ticketform = $("#ticketform").serialize();
            //        alert("success");
            //        $.ajax({
            //            type: "POST",
            //            url: "/Ticket/Index",
            //            data: ticketform,
            //            success: function () {
            //                $("loaderDiv").hide();
            //                $("MyModal").modal("hide");
            //            }

            //        })
            //    })
            //}
            //)
    </script>
}